{"version":3,"sources":["webpack:///webpack/bootstrap ebd5111c8720a39d3b20","webpack:///./client/src/client.cjsx","webpack:///./client/src/styles/global.less","webpack:///./client/src/components/FilesPanel.cjsx","webpack:///./client/src/styles/filesPanel.less","webpack:///./client/src/components/DirItem.cjsx","webpack:///./client/src/components/FileItem.cjsx","webpack:///./client/src/components/ImageItem.cjsx","webpack:///./client/src/components/DetailPanel.cjsx","webpack:///./client/src/styles/detailPanel.less","webpack:///./client/src/styles/menus.less","webpack:///./client/src/components/ContextMenu.cjsx","webpack:///./client/src/FileUploadManager.coffee","webpack:///./client/src/Uploader.coffee","webpack:///./client/src/components/FileNameItem.cjsx"],"names":[],"mappings":"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","file":"./client/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap ebd5111c8720a39d3b20\n **/","require './styles/global.less'\n\n#components\nFilesPanel = require './components/FilesPanel'\n#modules\nFileUploadManager = require './FileUploadManager'\n\n#关于components方法的命名\n#\n# - 用于交付给子组件触发的 props.interface 采用 on 开头的命名\n#   如： <ChildItem onEvent={xxx}>\n#\n# - 用于处理 props.interface 的方法采用 handle 开头的命名\n#   如： <ChildItem onEvent={@handleItemEvent}>\n#   如果可以直接调用已经存在的, 则允许直接调用公开方法\n#   如： <RefreshBtn onClick={@refresh}>\n#\n# - 其他自定义public方法命名随意, 但是不可以和上面两条冲突\n#\n# - 其他自定义private方法 (除了上三条之外的private方法) 以下划线开头\n\n\nclass DungeonClient extends Suzaku.EventEmitter\n  constructor:()->\n    super\n    @uploadManager = new FileUploadManager this\n\n    window.addEventListener \"dragover\",(evt)=>\n      console.log \"over\"\n      evt.preventDefault()\n    window.addEventListener \"dragleave\",(evt)=>\n      console.log \"leave\"\n      evt.preventDefault()\n    window.addEventListener \"drop\",(evt)=>\n      evt.stopPropagation()\n      evt.preventDefault()\n      currentDir = @filesPanel.state.currentDir\n      dt = evt.dataTransfer\n      console.log dt.items\n      if dt.getData('text/html')\n        @uploadManager.handleDragHtml currentDir,dt.getData('text/html')\n        @emit \"uploading\"\n      else if dt.items.length > 0\n        @uploadManager.handleDragFiles currentDir,dt.items\n        @emit \"uploading\"\n      else\n        console.log \"drop event unhandled\"\n\n    @uploadManager.on \"fileUploaded\",=>\n      @filesPanel.listDir()\n\n    @uploadManager.on \"uploadError\",(e)=>\n      @filesPanel.showMessage \"uploadError\"\n\n    @filesPanel = ReactDOM.render React.createElement(FilesPanel, {\"client\": (this)}),$(\"#main-container\")[0]\n\n    console.log \"inited Dungeon client\"\n\nnew DungeonClient()\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/cjsx-loader!./client/src/client.cjsx\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/src/styles/global.less\n ** module id = 1\n ** module chunks = 0\n **/","require '../styles/filesPanel.less'\n\nDirItem = require './DirItem'\nFileItem = require './FileItem'\nImageItem = require './ImageItem'\nDetailPanel = require './DetailPanel'\nContextMenu = require './ContextMenu'\n\nmodule.exports =\n  class FilesPanel extends React.Component\n    @FileTypes:\n      dir:\"directory\"\n      image:\"image\"\n      video:\"video\"\n      compressed:\"compressed\"\n      others:\"others\"\n\n    constructor:()->\n      super\n      @state =\n        currentDir:\"/\" # .e.g : \"/\" \"/movie\" \"/movie/sf\"\n        items:[]\n        error:false\n        dirStack:[]\n        message:'loading'\n      @props.client.on \"uploading\",=>\n        @setState message:\"uploading\"\n\n    listDir:->\n      $.get \"/listDir#{@state.currentDir}\",(data)=>\n        console.log \"got list data\",data\n        data.items.sort (a,b)->\n          #sort with name, dirs before files\n          (b.isDirectory - a.isDirectory) ||\n          (a.name.charCodeAt(0) - b.name.charCodeAt(0))\n        if data.items.length is 0\n          message = 'empty'\n        else\n          message = null\n        @setState {items:data.items, message:message}\n      .fail (e)=>\n        console.log \"error\",e\n        @setState {error:true, message:'error'}\n\n    changeDir:({newDir})->\n      dirStack = @state.dirStack.map (d)-> d\n      dirStack.push @state.currentDir\n      @setState {currentDir:newDir,dirStack:dirStack,message:'loading'},=>\n        @listDir()\n\n    goBack:->\n      # go back\n      dirStack = @state.dirStack.map (d)-> d\n      return if dirStack.length is 0\n      dir = dirStack.pop()\n      @setState {currentDir:dir,dirStack:dirStack,message:\"loading\"},=>\n        @listDir()\n\n    refresh:->\n      @setState {message:\"loading\"}\n      @listDir()\n\n    componentDidMount:->\n      @listDir()\n\n    showMessage:(msg)->\n      @setState message:msg\n\n    _showItemDetail:({itemType,itemData})->\n      @refs.detailPanel.showDetail itemType,itemData\n\n    createNewFolder:->\n      name = window.prompt \"请输入名称：\"\n      if name.indexOf(\"/\") > -1\n        return alert \"文件名不能含有'/'\"\n      return if not name\n      $.get \"/newFolder#{@state.currentDir}/#{name}\"\n      .done (res)=>\n        @listDir()\n      .fail (e)->\n        console.error e\n\n    handleMenuItemClick:({key,itemData})->\n      action = key\n      if itemData\n        @refs[itemData.relativePath].doFileAction action\n      else\n        switch action\n          when 'newFolder'\n            @createNewFolder()\n          when 'refresh'\n            @refresh()\n\n    handleContextMenu:(evt)->\n      console.log \"contextMenu\"\n      evt.stopPropagation()\n      evt.preventDefault()\n      @refs.contextMenu.show\n        menuItems:['newFolder','refresh']\n        itemData: null\n        position:\n          x:evt.pageX\n          y:evt.pageY - window.scrollY\n\n    handleItemEvent:(event,data)->\n      if data.itemData\n        data.itemType = @getItemType data.itemData\n      switch event\n        when 'enterDir'\n          @changeDir data\n        when 'showDetail'\n          @_showItemDetail data\n        when 'showContextMenu'\n          @refs.contextMenu.show data\n        when 'update'\n          @refresh()\n        else\n          console.error \"unsupported event type!\",event\n\n    getItemType:(itemData)->\n      ft = FilesPanel.FileTypes\n      if itemData.isDirectory\n        return ft.dir\n      extName = itemData.name.split(\".\").pop()\n      switch extName\n        when \"jpg\",\"jpeg\",\"png\"\n          ft.image\n        else\n          ft.others\n\n    render:->\n      React.createElement(\"section\", {\"className\": \"files-panel\"},\n        React.createElement(DetailPanel, {\"ref\": \"detailPanel\"}),\n        React.createElement(ContextMenu, {\"ref\": \"contextMenu\", \"onItemClick\": (@handleMenuItemClick.bind(@))}),\n        React.createElement(\"header\", {\"className\": \"main-header\"},\n          React.createElement(\"button\", {\"onClick\": (@refresh.bind(@))}, \"刷新\"),\n          React.createElement(\"button\", {\"onClick\": (@goBack.bind(@))}, \"后退\"),\n          React.createElement(\"span\", {\"className\": \"current-path\"}, (@state.currentDir))\n        ),\n        React.createElement(\"div\", {\"className\": \"files-holder\", \"onContextMenu\": (@handleContextMenu.bind(@))},\n          (\n            if @state.message\n              React.createElement(\"p\", {\"className\": \"message-holder\"}, (\n                switch @state.message\n                  when \"loading\" then \"载入中\"\n                  when \"error\" then \"载入错误\"\n                  when \"empty\" then \"没有文件\"\n                  when \"uploading\" then \"上传中...\"\n                  when \"uploadError\" then React.createElement(\"span\", {\"className\": \"error\"}, \"上传错误！\")\n              ))\n          ),\n          (\n            ft = FilesPanel.FileTypes\n            for item in @state.items\n              switch @getItemType item\n                when ft.dir\n                  React.createElement(DirItem, {\"key\": (item.relativePath),  \\\n                    \"ref\": (item.relativePath), \"data\": (item),  \\\n                    \"onEvent\": (@handleItemEvent.bind(@))})\n                when ft.image\n                  React.createElement(ImageItem, {\"key\": (item.relativePath),  \\\n                    \"ref\": (item.relativePath), \"data\": (item),  \\\n                    \"onEvent\": (@handleItemEvent.bind(@))})\n                else\n                  React.createElement(FileItem, {\"key\": (item.relativePath),  \\\n                    \"ref\": (item.relativePath), \"data\": (item),  \\\n                    \"onEvent\": (@handleItemEvent.bind(@))})\n          ),\n          React.createElement(\"div\", {\"className\": \"clearfix\"})\n        )\n      )\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/cjsx-loader!./client/src/components/FilesPanel.cjsx\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/src/styles/filesPanel.less\n ** module id = 6\n ** module chunks = 0\n **/","require '../styles/filesPanel.less'\nFileItem = require './FileItem'\nFileNameItem = require './FileNameItem'\n\nmodule.exports =\n  class DirItem extends FileItem\n    handleClick:(e)->\n      @props.onEvent \"enterDir\",{newDir:@props.data.relativePath}\n\n    render:->\n      React.createElement(\"div\", {\"className\": \"file-panel-item dir-item\",  \\\n        \"onClick\": (@handleClick.bind(@)),  \\\n        \"onContextMenu\": (@handleContextMenu.bind(@))},\n\n        React.createElement(\"div\", {\"className\": \"icon\"},\n          React.createElement(\"span\", {\"className\": \"preview\"})\n        ),\n\n        React.createElement(FileNameItem, {\"ref\": \"fileName\",  \\\n          \"name\": (@props.data.name),  \\\n          \"onChange\": (@handleRename.bind(@))})\n      )\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/cjsx-loader!./client/src/components/DirItem.cjsx\n **/","require '../styles/filesPanel.less'\nFileNameItem = require './FileNameItem'\n\nmodule.exports =\n  class FileItem extends React.Component\n    contextMenuItems:['download','saveAs','rename','delete']\n\n    doFileAction:(action)->\n      switch action\n        when 'download'\n          console.log \"download\"\n        when 'saveAs'\n          console.log \"saveAs\"\n        when 'rename'\n          @refs.fileName.edit()\n        when 'delete'\n          console.log \"delete\"\n          if @props.data.isDirectory\n            msg = \"确定要删除文件夹 #{@props.data.name} 及其所有文件吗？\"\n          else\n            msg = \"确定要删除文件 #{@props.data.name} 吗？\"\n          return if not window.confirm msg\n          url = \"/delete#{@props.data.relativePath}\"\n          @_callApi \"get\",url,@props.onEvent.bind(null,'update')\n        else\n          console.error \"unsupported action type:\",action\n\n    _callApi:(method=\"get\",url,callback)->\n      method = method.toUpperCase()\n      $.ajax\n        method:method\n        url:url\n      .done (res)->\n        callback res\n      .fail (e)->\n        console.error e\n\n    handleClick:(evt)->\n      @props.onEvent \"showDetail\",{itemData:@props.data}\n\n    handleRename:({newName})->\n      url = \"/rename#{@props.data.relativePath}?to=#{newName}\"\n      @_callApi 'get',url,=>\n        @props.onEvent \"update\",{itemData:@props.data}\n\n    handleContextMenu:(evt)->\n      evt.preventDefault()\n      evt.stopPropagation()\n      #rect = ReactDOM.findDOMNode(@).getBoundingClientRect()\n      #console.log evt.pageX,evt.pageY\n      @props.onEvent \"showContextMenu\",\n        menuItems: @contextMenuItems\n        itemData: @props.data\n        position:\n          x:evt.pageX\n          y:evt.pageY - window.scrollY\n\n    render:->\n      React.createElement(\"div\", {\"className\": \"file-panel-item file-item\",  \\\n        \"onClick\": (@handleClick.bind(@)),  \\\n        \"onContextMenu\": (@handleContextMenu.bind(@))},\n\n        React.createElement(\"div\", {\"className\": \"icon\"},\n          React.createElement(\"div\", {\"className\": \"preview\"}, \"File:\")\n        ),\n\n        React.createElement(FileNameItem, {\"ref\": \"fileName\",  \\\n          \"name\": (@props.data.name),  \\\n          \"onChange\": (@handleRename.bind(@))})\n      )\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/cjsx-loader!./client/src/components/FileItem.cjsx\n **/","require '../styles/filesPanel.less'\nFileItem = require './FileItem'\nFileNameItem = require './FileNameItem'\n\nmodule.exports =\n  class ImageItem extends FileItem\n    render:->\n      src = \"/imgPreview#{@props.data.relativePath}\"\n      React.createElement(\"div\", {\"className\": \"file-panel-item image-item\",  \\\n        \"onClick\": (@handleClick.bind(@)),  \\\n        \"onContextMenu\": (@handleContextMenu.bind(@))},\n\n        React.createElement(\"div\", {\"className\": \"icon\"},\n          React.createElement(\"img\", {\"src\": (src), \"className\": \"preview\"})\n        ),\n\n        React.createElement(FileNameItem, {\"ref\": \"fileName\",  \\\n          \"name\": (@props.data.name),  \\\n          \"onChange\": (@handleRename.bind(@))})\n      )\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/cjsx-loader!./client/src/components/ImageItem.cjsx\n **/","require '../styles/detailPanel.less'\n\nmodule.exports =\n  class DetailPanel extends React.Component\n    constructor:()->\n      super\n      @state = {itemData:null}\n\n    showDetail:(type,itemData)->\n      console.log \"showDetail\",type,itemData\n      @setState {itemType:type, itemData:itemData}\n\n    handleInnerClick:(evt)->\n      evt.stopPropagation()\n      evt.preventDefault()\n\n    dissmiss:(evt)->\n      @setState {itemData:null}\n\n    render:->\n      itemData = @state.itemData\n      if not itemData\n        return React.createElement(\"section\", {\"className\": \"hidden\"})\n      React.createElement(\"section\", {\"className\": \"detail-panel popup-layer\", \"onClick\": (@dissmiss.bind(@))},\n        React.createElement(\"button\", {\"className\": \"close-btn\", \"onClick\": (@dissmiss.bind(@))}, \"×\"),\n        (\n          ft = require('./FilesPanel').FileTypes\n          switch @state.itemType\n            when ft.image\n              src = \"/viewImage#{itemData.relativePath}\"\n              React.createElement(\"img\", {\"className\": \"content\", \"src\": (src), \"onClick\": (@handleInnerClick.bind(@))})\n            when ft.others\n              React.createElement(\"div\", {\"className\": \"content\", \"onClick\": (@handleInnerClick.bind(@))},\n                React.createElement(\"p\", null, (\"no preview for this file\"))\n              )\n        ),\n        React.createElement(\"span\", {\"className\": \"name\"}, (@state.itemData.name))\n      )\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/cjsx-loader!./client/src/components/DetailPanel.cjsx\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/src/styles/detailPanel.less\n ** module id = 12\n ** module chunks = 0\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./client/src/styles/menus.less\n ** module id = 18\n ** module chunks = 0\n **/","require '../styles/menus.less'\n\nmodule.exports =\n  class ContextMenu extends React.Component\n    @NameDict:\n      'rename':'重命名'\n      'download':'下载'\n      'saveAs':'另存为'\n      'delete':'删除'\n      'newFolder':'新建文件夹'\n      'refresh':'刷新'\n\n    constructor:()->\n      super\n      @state = {}\n\n    show:({menuItems,itemData,position})->\n      @setState items:menuItems,itemData:itemData,position:position\n\n    handleListItemClick:(key,evt)->\n      evt.stopPropagation()\n      console.log \"menu item clicked:\",key\n      @props.onItemClick itemData:@state.itemData,key:key\n      @dismiss()\n\n    dismiss:(evt)->\n      @setState items:null\n\n    render:->\n      if not @state.items or @state.items.length is 0\n        return React.createElement(\"section\", {\"className\": \"hidden\"})\n\n      pos = @state.position\n\n      React.createElement(\"section\", {\"className\": \"menu-wrapper popup-layer\", \"onClick\": (@dismiss.bind(@))},\n        React.createElement(\"ul\", {\"className\": \"menu item-context-menu\", \"style\": (left:pos.x,top:pos.y)},\n          (\n            for key in @state.items\n              React.createElement(\"li\", {\"key\": (key), \"onClick\": (@handleListItemClick.bind(@,key))},\n                (ContextMenu.NameDict[key])\n              )\n          )\n        )\n      )\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/cjsx-loader!./client/src/components/ContextMenu.cjsx\n **/","EventEmitter = Suzaku.EventEmitter\n\nUploader = require './Uploader'\n\nmodule.exports =\n  class FileUploadManager extends EventEmitter\n    constructor:(client)->\n      super\n\n    handleDragHtml:(currentDir,html)->\n      rootElem = $(\"<div>\" + html.replace(/<script/g,'<_script') + \"</div>\")\n      srcs = (img.src for img in rootElem.find(\"img\"))\n      console.log srcs\n      if srcs.length is 0 then return false\n      for url in srcs\n        $.post \"/grabImage#{currentDir}\",JSON.stringify {url:url}\n        .done (data)=>\n          @emit \"fileUploaded\"\n        .fail (e)=>\n          console.log \"error\",e\n\n    handleDragFiles:(currentDir,items)->\n      @_readDataTransferItems items\n      .then ([files,emptyFolderPaths])=>\n        console.log files,emptyFolderPaths\n        totalSize = 0\n        totalSize += f.size for f in files\n        console.log \"total file size is #{totalSize/1024/1024}MB\"\n        p = Promise.resolve()\n        console.log \"#{files.length} files to go\"\n        files.forEach (file)=>\n          p = p.then =>\n            relativeDir = file.relativeDir[1..]\n            console.log relativeDir\n            dir = \"#{currentDir}#{relativeDir}\"\n            @uploadFile dir,file\n        for path in emptyFolderPaths\n          p = p.then =>\n            @_createEmptyFolder path\n        p.then (e)=>\n          console.log \"finished\"\n          @emit \"fileUploaded\"\n      .catch (e)=>\n        console.error e.stack\n        console.error \"upload error\"\n        @emit \"uploadError\",e\n\n    uploadFile:(currentDir,file)->\n      new Promise (resolve, reject)->\n        console.log \"start upload #{file.name}\"\n        uploader = new Uploader()\n        uploader.upload(currentDir,file)\n        uploader.on \"complete\",->\n          resolve()\n        uploader.on \"error\",(e)->\n          reject e\n\n    _createEmptyFolder:(path)->\n      new Promise (resolve,reject)->\n        console.log \"/newFolder#{path}\"\n        $.get \"/newFolder#{path}\"\n        .done (res)=>\n          resolve()\n        .fail (e)->\n          reject e\n\n    _readDataTransferItems:(items)->\n      console.log items.length\n      items = Array::map.call items,(i)-> i.webkitGetAsEntry()\n      files = items.filter (i)-> i.isFile\n      files.forEach (i)-> i.relativeDir = '/' #'/' or '/movie' or '/movie/sf'\n      folders = items.filter (i)-> i.isDirectory\n      emptyFolders = []\n\n      new Promise (resolve, reject)->\n        iter = ()->\n          # get one folder\n          folder = folders.pop()\n          if not folder\n            #resolve when theres no more folder remain\n            return resolve()\n          reader = folder.createReader()\n          console.log \"for folder #{folder.fullPath}\"\n          new Promise (_resolve)->\n            # get all entries from the folder\n            entries = []\n            gatherCounter = 0\n            gatherEntriesFromFolder = ->\n              gatherCounter += 1\n              reader.readEntries (results)->\n                console.log \"result:\",results\n                if results.length > 0\n                  entries.push entry for entry in results\n                  gatherEntriesFromFolder()\n                else\n                  if gatherCounter is 1 #folder is empty\n                    emptyFolders.push folder\n                  _resolve entries\n              ,(err)->\n                reject err\n            gatherEntriesFromFolder()\n          .then (entries)->\n            # travalse the entries and get files and folders\n            for i in entries\n              if i.isFile\n                i.relativeDir = folder.fullPath\n                files.push i\n              if i.isDirectory\n                folders.push i\n            iter() # go with next folder\n        iter() #start\n\n      .then ->\n        #change all files object\n        Promise.all files.map (f)->\n          new Promise (resolve, reject)->\n            f.file (file)->\n              file.relativeDir = f.relativeDir\n              resolve file\n            ,(err)->\n              reject err\n      .then (fileObjects)->\n        emptyFolderPaths = emptyFolders.map (f)->f.fullPath\n        Promise.resolve [fileObjects,emptyFolderPaths]\n\n\n\n/** WEBPACK FOOTER **\n ** ./client/src/FileUploadManager.coffee\n **/","EventEmitter = Suzaku.EventEmitter\n\nsize =\n  kb:1024\n  mb:1024 * 1024\n\nmodule.exports =\n  class Uploader extends EventEmitter\n    constructor:()->\n      super\n      @sliceSize = 3 * size.mb\n      #maxThreads = 3\n      @maxThreads = 2\n      @file = null\n      @availThreads = 0\n      @sliceCount = 0\n      @apiPath = null\n      @currentSlice = 0\n      @currentDir = \"/\"\n\n    upload:(@currentDir,@file)->\n      #check\n      xhr = new XMLHttpRequest()\n      xhr.open \"GET\",\"/check#{@currentDir}?filename=#{@file.name}&size=#{@file.size}\"\n      xhr.send()\n      xhr.onreadystatechange = (evt)=>\n        if xhr.readyState is 4\n          if xhr.status is 200\n            @doUpload()\n          else\n            console.error \"preCheck error for file:\",@file\n            @emit \"error\",xhr.responseText\n\n    doUpload:->\n      # r = new FileReader()\n      # r.readAsBinaryString @file\n      # r.onload = (e)=>\n      #   console.log r.result\n      #   @showResult r.result\n      #   r = null\n      if @file.size > 0\n        @sliceCount = Math.ceil(@file.size/@sliceSize)\n      else\n        @sliceCount = 1\n      @availThreads = @maxThreads\n      console.log \"sliceCount is #{@sliceCount}\"\n      @currentSlice = 0\n      console.log \"got file #{@file.name} total size #{@file.size}\"\n      console.log \"uploading using sliceSize #{@sliceSize} and #{@maxThreads} threads\"\n\n      @on \"sliceProgress\",(slice,percentage)=>\n        #TODO calculate total progress\n        @emit \"progress\"\n\n      @on \"sliceComplete\",(slice)=>\n        @availThreads += 1\n        if slice < (@sliceCount - 1)\n          #still has slice to upload\n          @uploadNextSlice()\n        else if @availThreads is @maxThreads\n          #all slice has been uploaded\n          @emit \"complete\"\n\n      @uploadNextSlice()\n\n    uploadNextSlice:()->\n      return unless @currentSlice < @sliceCount and @availThreads > 0\n      @availThreads -= 1\n      @uploadSlice @currentSlice\n      @currentSlice += 1\n      @uploadNextSlice()\n\n    uploadSlice:(slice)->\n      return unless slice < @sliceCount\n      name = @file.name\n      if @file.size > 0\n        start = slice * @sliceSize\n        stop = (slice + 1) * @sliceSize - 1\n        if stop > (@file.size - 1) then stop = @file.size - 1\n      else\n        start = stop = 0\n      #console.log \"upload slice\",slice,start,\"~\",stop,\"availThreads #{@availThreads}\"\n      bolb = @file.slice start,stop + 1\n\n      reader = new FileReader()\n      reader.readAsBinaryString bolb\n      reader.onloadend = (e)=>\n        if reader.readyState is FileReader.DONE\n          @emit \"onload\"\n          #@showResult reader.result\n          @sendAsBinary xhr,reader.result\n          #@showResult reader.result\n          reader = null\n\n      xhr = new XMLHttpRequest()\n      xhr.upload.onprogress = (evt)=>\n        if evt.lengthComputable\n          percentage = Math.round((evt.loaded * 100) / evt.total);\n          @emit \"sliceProgress\",slice,percentage\n      xhr.onreadystatechange = (evt)=>\n        if xhr.readyState is 4\n          if xhr.status is 200\n            @emit \"sliceComplete\",slice\n          else\n            @emit \"error\",xhr.responseText\n      url = \"/upload#{@currentDir}?start=#{start}&stop=#{stop}&filename=#{name}\"\n      xhr.open \"POST\",url\n\n    sendAsBinary:(xhr, data)->\n      @xhr = new XMLHttpRequest()\n      parts = new Uint8Array(data.length)\n      if data.length > 0\n        parts = new Uint8Array(data.length)\n        for i in [0..data.length-1]\n          parts[i] = data[i].charCodeAt(0)\n        xhr.send(parts.buffer)\n      else\n        xhr.send('')\n\n    showResult:(res, label)->\n      markup = []\n      for n in [0..(res.length-1)]\n        aByte = res.charCodeAt(n)\n        byteStr = aByte.toString(16)\n        if byteStr.length < 2\n          byteStr = \"0\" + byteStr\n        markup.push(byteStr)\n      console.log markup.join(\" \")\n\n\n\n/** WEBPACK FOOTER **\n ** ./client/src/Uploader.coffee\n **/","require '../styles/filesPanel.less'\n\nmodule.exports =\n  class FileNameItem extends React.Component\n    constructor:()->\n      super\n      @state = {editing:false}\n    edit:->\n      @setState editing:true,=>\n        @refs.input.focus()\n        @refs.input.select()\n\n    handleKeyDown:(evt)->\n      switch evt.keyCode\n        when Suzaku.Key.enter\n          console.log evt.target.value\n          @props.onChange newName:evt.target.value\n          @setState editing:false\n\n    handleClick:(evt)->\n      evt.stopPropagation()\n\n    handleBlur:(evt)->\n      @setState editing:false\n\n    render:->\n      if @state.editing\n        React.createElement(\"input\", {\"ref\": \"input\", \"className\": \"file-name-input\", \"type\": \"text\",  \\\n          \"onClick\": (@handleClick.bind(@)),  \\\n          \"onKeyDown\": (@handleKeyDown.bind(@)),  \\\n          \"onBlur\": (@handleBlur.bind(@)),  \\\n          \"defaultValue\": (@props.name)})\n      else\n        React.createElement(\"p\", {\"className\": \"name\"}, (@props.name))\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/cjsx-loader!./client/src/components/FileNameItem.cjsx\n **/"],"sourceRoot":""}